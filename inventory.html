<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Inventory</title>

        <!-- Bootstrap -->
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/main.css" rel="stylesheet">
        <link href='http://fonts.googleapis.com/css?family=Raleway:400,700,100' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>
    <body>
        <span id="navbar" onload="$(this).addClass('active')"></span>
        <div id="container">
        <h1>Inventory</h1>
        <div id="items">
            <!--<div class="item panel panel-default">
                <div class="panel-body">
                    <img src="images/apple.jpg" class="icon" height="50" width="50"/>
                    <div class="info" style="float: left;">
                        <h4><span class="item_name">Apple</span></h4> x<span class="quantity">2</span> <br>
                        Expires: <input type="date" class="exp_date" value="04/20/2014">
                        </div>
                        <span class="item_buttons">
                            <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-plus-sign"></span></button> 
                            <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-minus-sign"></span></button>
                            <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-trash"></span></button>
                        </span>
                    <div class="clear"></div>
                </div>
            </div> --><!-- /.item -->
        </div>
        </div> <!--/#container -->
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="js/bootstrap.min.js"></script>
        
        <script>
            $("#navbar").load("./navbar.html");
            $("#nav_add").addClass("active"); // TODO: make this line work
            items = {}; // associate ids item names
            item = function(id, quality, item_name, img_src, quantity, date) {
                items[id] = item_name;
                // hahaha
                return ('' +
                    '<div class="item ' + quality + ' panel panel-default" id="' + id +'">' +
                    '<div class="panel-body">' + 
                        '<img src="' + img_src + '" class="icon" height="70" width="70"/>'+
                        '<div class="info" style="float: left;">'+
                            '<h4><span class="item_name">' + item_name + '</span></h4> x<span class="quantity" id="quantity' + id +'">' + quantity + '</span> <br>'+
                           'Expires: <input type="date" class="exp_date" value="' + date + '">'+
                        '</div>'+
                            '<span class="item_buttons">'+
                                '<button type="button" class="btn btn-default plus" id="plus' + id + '"><span class="glyphicon glyphicon-plus-sign"></span></button>'+
                                '<button type="button" class="btn btn-default minus" id="minus' + id + '"><span class="glyphicon glyphicon-minus-sign"></span></button>'+
                                '<button type="button" class="btn btn-default"><span class="glyphicon glyphicon-trash"></span></button>'+
                            '</span>'+
                        '<div class="clear"></div>'+
                    '</div>'+
                '</div> ');
            }
            $('#items').append(item(1, 'bad', 'Apples', 'images/apple.jpg', 2, '2014-04-16'));
            $('#items').append(item(2, 'bad', 'Milk', 'images/milk.jpg', 1, '2014-04-17'));
            $('#items').append(item(3, 'okay', 'Bread', 'images/bread.jpg', 1, '2014-04-18'));
            $('#items').append(item(4, 'okay', 'Bananas', 'images/banana.jpg', 3, '2014-04-18'));
            $('#items').append(item(5, 'okay', 'Avocados', 'images/avocado.jpg', 2, '2014-04-20'));
            $('#items').append(item(6, 'good', 'Cheese', 'images/cheese.jpg', 1, '2014-04-22'));
            $('#items').append(item(7, 'good', 'Chicken thighs', 'images/chicken.jpg', 4, '2014-04-24'));
            $('#items').append(item(8, 'good', 'Peaches', 'images/peach.jpg', 5, '2014-04-24'));
            $('#items').append(item(9, 'good', 'Oranges', 'images/orange.jpg', 2, '2014-04-25'));
            $('#items').append(item(10, 'good', 'Lettuce', 'images/lettuce.jpg', 1, '2014-04-26'));
            changeValue = function(id, amount) {
               quantity = $('#quantity' + id);
               num = parseInt(quantity.html()) + amount;
               quantity.html(num);
               // if value < 0 -> delete item
               if (num <= 0) {
                    $('#' + id).remove();
                    $('#items').prepend('<div class="alert alert-warning fade in">' +
                       '<button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>' +
                        '<strong>' + items[id] + '</strong> deleted.' +
                        '</div>');
               }
            }

            $('.plus').click(
                function(event) {
                    // check if clicking button or span? Pick the parent (button) if span was clicked.
                    button = $(event.target)[0];
                    // might have clicked on span...
                    if ($(button).is('span')) {
                        button = $(button).parent();
                    } else {
                        button = $(button);
                    }
                    button_id = button.attr('id');
                    id = button_id.split("plus")[1];
                    changeValue(id, 1);
                });
            $('.minus').click(
                function(event) {
                    // check if clicking button or span? Pick the parent (button) if span was clicked.
                    button = $(event.target)[0];
                    // might have clicked on span...
                    if ($(button).is('span')) {
                        button = $(button).parent();
                    } else {
                        button = $(button);
                    }
                    button_id = button.attr('id');
                    id = button_id.split("minus")[1];
                    changeValue(id, -1);
                });
        </script>
    </body>
</html>